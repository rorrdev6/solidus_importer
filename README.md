# Solidus Importer

This extension aims to create a component to import data from other popular
e-commerce solutions to Solidus.

## Installation

Add solidus_importer to your Gemfile:

```ruby
gem 'solidus_importer'
```

Bundle your dependencies and run the installation generator:

```shell
bundle
bundle exec rails g solidus_importer:install
```

## Usage

Sample code to import some products:

```ruby
import = SolidusImporter::Import.new(import_type: 'products')
import.import_file = 'some_path/sample_products.csv'
import.save
SolidusImporter::ProcessImport.new(import).process
```

To process in background: `SolidusImporter::ImportJob.perform_later(import.id)`

## Configuration

To define your own processors (in this example for products), add to the spree
initializer:

```ruby
SolidusImporter::Config[:solidus_importer] = {
  products: {
    importer: SolidusImporter::Importers::Products,
    processors: [
      SolidusImporter::Processors::Product,
      SolidusImporter::Processors::Variant,
      SolidusImporter::Processors::Log
    ]
  }
}
```

The `importer` class is responsible of the whole import process of a single
source file. The `processors` classes are responsible of the import of a single
row of the source file; every processor has a `call` method (with an input
`context`) which makes a specific action and updates the context if needed.

## Testing

First bundle your dependencies, then run `rake`. `rake` will default to building
the dummy app if it does not exist, then it will run specs, and [Rubocop](https://github.com/bbatsov/rubocop) static code analysis. The dummy app can be regenerated by using
`rake test_app`.

```shell
bundle
bundle exec rake
```

When testing your application's integration with this extension you may use its factories.
Simply add this require statement to your spec_helper:

```ruby
require 'solidus_importer/factories'

```
Sandbox app
-----------

To run this extension in a sandboxed Solidus application you can run `bin/sandbox`
The path for the sandbox app is `./sandbox` and `bin/rails` will forward any Rails command
to `sandbox/bin/rails`.

Example:

```shell
$ bin/rails server
=> Booting Puma
=> Rails 6.0.2.1 application starting in development
* Listening on tcp://127.0.0.1:3000
Use Ctrl-C to stop
```

Releasing
---------

Your new extension version can be released using `gem-release` like this:

```shell
bundle exec gem bump -v VERSION --tag --push --remote upstream && gem release
```

## About

Copyright (c) 2020 Nebulab SRL, released under the New BSD License
